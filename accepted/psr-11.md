## PSR-11: Интерфейс Контейнера

Этот документ описывает общий интерфейс для контейнеров внедрения зависимостей.

Цель, поставленная `ContainerInterface`, заключается в стандартизации того, как фреймворки и библиотеки используют контейнер для получения объектов и параметров (называемых *записями* в остальной части этого документа).

Ключевые слова 'ДОЛЖНЫ', 'НЕ ДОЛЖНЫ', 'ТРЕБУЕТСЯ', 'НУЖНО', 'НЕ НУЖНО', 'СЛЕДУЕТ', 'НЕ СЛЕДУЕТ', 'РЕКОМЕНДУЕТСЯ', 'МОЖЕТ' и 'НЕОБЯЗАТЕЛЬНО' в этом документе должны толковаться так, как описано в [RFC 2119](../rfc2119.md).

Под словом `implementor` в этом документе следует понимать человека, реализующего `ContainerInterface` в библиотеке или фреймворке, связанных с внедрением зависимостей. Пользователей контейнеров внедрения зависимостей (DIC) будем называть как `user`.

#### 1. Спецификация

##### 1.1 Основы

###### 1.1.1 Идентификаторы Записи

Идентификатор записи - это любая допустимая в PHP строка, содержащая хотя бы один символ, который однозначно идентифицирует элемент в контейнере. Идентификатор записи является непрозрачной строкой, поэтому вызывающие объекты НЕ ДОЛЖНЫ предполагать, что структура строки несет в себе семантическое значение.

###### 1.1.2 Чтение из Контейнера

* Интерфейс `Psr\Container\ContainerInterface` предоставляет два метода: `get` и `has`.
* Метод `get` принимает один обязательный параметр: идентификатор записи, который ДОЛЖЕН быть строкой. Метод `get` может вернуть что-либо (значение *mixed*) или выбросить исключение `NotFoundExceptionInterface`, если идентификатор неизвестен контейнеру. Два последовательных вызова `get` с одним и тем же идентификатором ДОЛЖНЫ возвращать одно и то же значение. Однако, в зависимости от конструкции `implementor` и/или конфигурации `user`, могут быть возвращены различные значения, поэтому `user` НЕ ДОЛЖЕН полагаться на получение одного и того же значения при 2 последовательных вызовах.
* Метод `has` принимает один уникальный параметр: идентификатор записи, который ДОЛЖЕН быть строкой. Метод `has` ДОЛЖЕН возвращать `true`, если идентификатор записи известен контейнеру и `false`, если это не так. Если `has($id)` возвращает false, то `get($id)` ДОЛЖЕН выбросить исключение `NotFoundExceptionInterface`.

##### 1.2 Исключения

Исключения, непосредственно создаваемые контейнером, ДОЛЖНЫ реализовывать интерфейс [`Psr\Container\ContainerExceptionInterface`](#32-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81-psrcontainercontainerexceptioninterface).

Вызов метода `get` с несуществующим идентификатором ДОЛЖЕН выбросить исключение [`Psr\Container\NotFoundExceptionInterface`](#33-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81-psrcontainernotfoundexceptioninterface).

##### 1.3 Рекомендуемое Использование

Пользователи НЕ ДОЛЖНЫ передавать контейнер в объект, чтобы объект мог получить *свои собственные зависимости*. Это означает, что контейнер используется в качестве [Локатора Служб][service-locator], который обычно не рекомендуется использовать.

Пожалуйста, обратитесь к разделу 4 META-документа для более подробной информации.

#### 2. Пакет

Описанные интерфейсы и классы, а также соответствующие исключения предоставляются как часть пакета [psr/container][containerpckg].

Пакеты, предоставляющие реализацию контейнера PSR, должны объявить, что они предоставляют `psr/container-implementation` `1.0.0`.

Проекты, требующие реализации, должны запрашиивать `psr/container-implementation` `1.0.0`.

#### 3. Интерфейсы 

##### 3.1. Интерфейс Psr\Container\ContainerInterface

```php
<?php
namespace Psr\Container;

/**
 * Описывает интерфейс контейнера, который предоставляет методы для чтения его записей.
 */
interface ContainerInterface
{
    /**
     * Находит запись контейнера по его идентификатору и возвращает его.
     *
     * @param string $id Идентификатор записи для поиска.
     *
     * @throws NotFoundExceptionInterface  Для **this** идентификатора не найдено ни одной записи.
     * @throws ContainerExceptionInterface Ошибка при получении записи.
     *
     * @return mixed Запись.
     */
    public function get($id);

    /**
     * Возвращает true, если контейнер может вернуть запись для данного идентификатора.
     * В противном случае возвращает false.
     *
     * `has($id)` возвращение true не означает, что `get($id)` не будет выбрасывать исключение.
     * Однако, это означает, что `get($id)` не будет выбрасывать `NotFoundExceptionInterface`.
     *
     * @param string $id Идентификатор записи для поиска.
     *
     * @return bool
     */
    public function has($id);
}
```

##### 3.2. Интерфейс Psr\Container\ContainerExceptionInterface

```php
<?php
namespace Psr\Container;

/**
 * Базовый интерфейс, представляющий в контейнере общее исключение.
 */
interface ContainerExceptionInterface
{
}
```

##### 3.3. Интерфейс Psr\Container\NotFoundExceptionInterface

```php
<?php
namespace Psr\Container;

/**
 * В контейнере не было найдено записей.
 */
interface NotFoundExceptionInterface extends ContainerExceptionInterface
{
}
```

[service-locator]: https://ru.wikipedia.org/wiki/%D0%9B%D0%BE%D0%BA%D0%B0%D1%82%D0%BE%D1%80_%D1%81%D0%BB%D1%83%D0%B6%D0%B1
[containerpckg]: https://packagist.org/packages/psr/container
